!function(n){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.ActionDispatcher=n()}}(function(){return function n(e,t,r){function o(u,f){if(!t[u]){if(!e[u]){var c="function"==typeof require&&require;if(!f&&c)return c(u,!0);if(i)return i(u,!0);var s=new Error("Cannot find module '"+u+"'");throw s.code="MODULE_NOT_FOUND",s}var a=t[u]={exports:{}};e[u][0].call(a.exports,function(n){var t=e[u][1][n];return o(t?t:n)},a,a.exports,n,e,t,r)}return t[u].exports}for(var i="function"==typeof require&&require,u=0;u<r.length;u++)o(r[u]);return o}({1:[function(n,e){var t=n("promise"),r=function(n){return function(e,t){s.prototype.addListener.call(this,e,t,n)}},o=function(n){return function(e,t){s.prototype.removeListener.call(this,e,t,n)}},i=function(n){var e=0;return this._listeners.some(function(t,r){return t.priority>n?!0:void(e=r+1)}),e},u=function(n,e,t){var r=-1;return this._listeners.some(function(o,i){return o.handler===n&&o.context===e&&o.priority===t?(r=i,!0):void 0}),r},f=function(n,e,t,r,o){var i=n[e];if("undefined"==typeof i)return void r();try{var u=i.handler.apply(i.context,t);if(c(u))return void u.then(function(){f(n,e+1,t,r,o)},o)}catch(s){return void o(s)}f(n,e+1,t,r,o)},c=function(n){return"undefined"!=typeof n&&null!==n&&"then"in n&&"function"==typeof n.then},s=function(){this._listeners=[]};s.BEFORE_HANDLERS_PRIORITY=5,s.HANDLERS_PRIORITY=10,s.AFTER_HANDLERS_PRIORITY=15,s.DEFAULT_PRIORITY=20,s.prototype={constructor:s,addListenerBeforeHandlers:r(s.BEFORE_HANDLERS_PRIORITY),removeListenerBeforeHandlers:o(s.BEFORE_HANDLERS_PRIORITY),addHandler:r(s.HANDLERS_PRIORITY),removeHandler:o(s.HANDLERS_PRIORITY),addListenerAfterHandlers:r(s.AFTER_HANDLERS_PRIORITY),removeListenerAfterHandlers:o(s.AFTER_HANDLERS_PRIORITY),addListener:function(n,e,t){t="undefined"==typeof t&&s.DEFAULT_PRIORITY||+t;var r=i.call(this,t);this._listeners.splice(r,0,{handler:n,context:e,priority:t})},removeListener:function(n,e,t){t="undefined"==typeof t&&s.DEFAULT_PRIORITY||+t;var r=u.call(this,n,e,t);return-1!==r&&this._listeners.splice(r,1),-1!==r},dispatch:function(){var n=this._listeners,e=arguments;return new t(function(t,r){f(n,0,e,t,r)})}},e.exports=s},{promise:4}],2:[function(n,e){function t(){for(;o.next;){o=o.next;var n=o.task;o.task=void 0;var e=o.domain;e&&(o.domain=void 0,e.enter());try{n()}catch(r){if(c)throw e&&e.exit(),setTimeout(t,0),e&&e.enter(),r;setTimeout(function(){throw r},0)}e&&e.exit()}u=!1}function r(n){i=i.next={task:n,domain:c&&process.domain,next:null},u||(u=!0,f())}var o={task:void 0,next:null},i=o,u=!1,f=void 0,c=!1;if("undefined"!=typeof process&&process.nextTick)c=!0,f=function(){process.nextTick(t)};else if("function"==typeof setImmediate)f="undefined"!=typeof window?setImmediate.bind(window,t):function(){setImmediate(t)};else if("undefined"!=typeof MessageChannel){var s=new MessageChannel;s.port1.onmessage=t,f=function(){s.port2.postMessage(0)}}else f=function(){setTimeout(t,0)};e.exports=r},{}],3:[function(n,e){"use strict";function t(n){function e(n){return null===s?void l.push(n):void i(function(){var e=s?n.onFulfilled:n.onRejected;if(null===e)return void(s?n.resolve:n.reject)(a);var t;try{t=e(a)}catch(r){return void n.reject(r)}n.resolve(t)})}function u(n){try{if(n===p)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var e=n.then;if("function"==typeof e)return void o(e.bind(n),u,f)}s=!0,a=n,c()}catch(t){f(t)}}function f(n){s=!1,a=n,c()}function c(){for(var n=0,t=l.length;t>n;n++)e(l[n]);l=null}if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");var s=null,a=null,l=[],p=this;this.then=function(n,o){return new t(function(t,i){e(new r(n,o,t,i))})},o(n,u,f)}function r(n,e,t,r){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof e?e:null,this.resolve=t,this.reject=r}function o(n,e,t){var r=!1;try{n(function(n){r||(r=!0,e(n))},function(n){r||(r=!0,t(n))})}catch(o){if(r)return;r=!0,t(o)}}var i=n("asap");e.exports=t},{asap:2}],4:[function(n,e){"use strict";function t(n){this.then=function(e){return"function"!=typeof e?this:new r(function(t,r){o(function(){try{t(e(n))}catch(o){r(o)}})})}}var r=n("./core.js"),o=n("asap");e.exports=r,t.prototype=Object.create(r.prototype);var i=new t(!0),u=new t(!1),f=new t(null),c=new t(void 0),s=new t(0),a=new t("");r.resolve=function(n){if(n instanceof r)return n;if(null===n)return f;if(void 0===n)return c;if(n===!0)return i;if(n===!1)return u;if(0===n)return s;if(""===n)return a;if("object"==typeof n||"function"==typeof n)try{var e=n.then;if("function"==typeof e)return new r(e.bind(n))}catch(o){return new r(function(n,e){e(o)})}return new t(n)},r.from=r.cast=function(n){var e=new Error("Promise.from and Promise.cast are deprecated, use Promise.resolve instead");return e.name="Warning",console.warn(e.stack),r.resolve(n)},r.denodeify=function(n,e){return e=e||1/0,function(){var t=this,o=Array.prototype.slice.call(arguments);return new r(function(r,i){for(;o.length&&o.length>e;)o.pop();o.push(function(n,e){n?i(n):r(e)}),n.apply(t,o)})}},r.nodeify=function(n){return function(){var e=Array.prototype.slice.call(arguments),t="function"==typeof e[e.length-1]?e.pop():null;try{return n.apply(this,arguments).nodeify(t)}catch(i){if(null===t||"undefined"==typeof t)return new r(function(n,e){e(i)});o(function(){t(i)})}}},r.all=function(){var n=1===arguments.length&&Array.isArray(arguments[0]),e=Array.prototype.slice.call(n?arguments[0]:arguments);if(!n){var t=new Error("Promise.all should be called with a single array, calling it with multiple arguments is deprecated");t.name="Warning",console.warn(t.stack)}return new r(function(n,t){function r(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var f=u.then;if("function"==typeof f)return void f.call(u,function(n){r(i,n)},t)}e[i]=u,0===--o&&n(e)}catch(c){t(c)}}if(0===e.length)return n([]);for(var o=e.length,i=0;i<e.length;i++)r(i,e[i])})},r.reject=function(n){return new r(function(e,t){t(n)})},r.race=function(n){return new r(function(e,t){n.forEach(function(n){r.resolve(n).then(e,t)})})},r.prototype.done=function(){var n=arguments.length?this.then.apply(this,arguments):this;n.then(null,function(n){o(function(){throw n})})},r.prototype.nodeify=function(n){return"function"!=typeof n?this:void this.then(function(e){o(function(){n(null,e)})},function(e){o(function(){n(e)})})},r.prototype["catch"]=function(n){return this.then(null,n)}},{"./core.js":3,asap:2}]},{},[1])(1)});